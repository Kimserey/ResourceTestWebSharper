(function(){var $$=this,$=this.IntelliFactory.Runtime,a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w;$.Define($$,{ResourceTestWebSharper:{WebSite:{Client:{AjaxHelper:{AjaxOptions:$.Class({},{get_GET:function(){return $.New(e,{Url:"",RequestType:"GET",Headers:{$:0},Data:{$:0},ContentType:{$:0}});},get_POST:function(){var x;x=e.get_GET();return $.New(e,{Url:x.Url,RequestType:"POST",Headers:x.Headers,Data:x.Data,ContentType:x.ContentType});}}),httpRequest:function(y){return f.Delay(function(){return f.TryWith(f.Delay(function(){var B;B=function(C){var D,E,F,G,J,L,M,O,P,R,S;D=C[0];E=C[1];F=C[2];G={url:y.Url,type:y.RequestType,dataType:"json",success:function(H){return D(H);},error:function(I){return E(g.New1($$.String(I.status)));}};J=function(K){G.contentType=K;};L=y.ContentType;h.iter(J,L);M=function(N){G.headers=$.NewObject(N);};O=y.Headers;h.iter(M,O);P=function(Q){G.data=Q;};R=y.Data;h.iter(P,R);S=i.ajax(G);return;};return f.Bind(f.FromContinuations(B),function(T){return f.Return({$:0,$0:T});});}),function(U){var V;V=j(U);k?k.log(V):undefined;return f.Return({$:1,$0:U.message});});});}},Remoting:{CustomXhrProvider:$.Class({AddHeaders:function(W){W.Authorization="Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJjb20ua2ltc2VyZXkiLCJzdWIiOiJzb21lX3VzZXIiLCJleHAiOiIyMDE2LTEyLTE0VDIzOjUzOjQxLjA0NTA3OThaIiwiaWF0IjoiMjAxNi0xMi0xNFQyMzo1MTo0MS4wNDUwNzk4WiIsImp0aSI6IjJmMDhlZTAxMDgwNjQ5NzdhMjE5Yjk0NmNiNWU0YWJkIn0.UsRwXaqKrnIENQFw6jp78P79u1R-caGg-NnldvoK0I0";return W;},Async:function(X,Y,Z,_0,_1){var _2;_2=this.AddHeaders(Y);return l.originalProvider().Async(X,_2,Z,_0,_1);},Sync:function(_3,_4,_5){var _6;_6=this.AddHeaders(_4);return l.originalProvider().Sync(_3,_6,_5);}},{New:function(){return $.New(this,{});}}),installBearer:function(){var _7;_7=m.New();n.AjaxProvider=function(){return _7;};return;},originalProvider:$.Field(function(){return n.AjaxProvider();})},onAjaxClick:function(_8){var _9;_9=f.Delay(function(){var ba;ba=e.get_GET();return f.Bind(d.httpRequest($.New(e,{Url:"something",RequestType:ba.RequestType,Headers:ba.Headers,Data:ba.Data,ContentType:ba.ContentType})),function(bb){var bc,bd;if(bb.$==1){bb.$0;bc=f.Return(null);}else{bd=bb.$0;_8($$.String(bd));bc=f.Return(null);}return bc;});});return f.Start(_9,{$:0});},onClick:function(bd){var be;be=f.Delay(function(){return f.Bind(o.Async("ResourceTestWebSharper:0",[]),function(bg){bd(bg);return f.Return(null);});});return f.Start(be,{$:0});},page:function(){var bh,bi,bj,bk,bl,bm,bn,bq,br;l.installBearer();bh=r.Create("");bi=r.Create("");bj=s.ofArray([t.Create("class","box")]);bk=s.ofArray([u.TextView(bh.get_View())]);bl=s.ofArray([u.TextView(bi.get_View())]);bn=function(){return c.onClick(function(bp){return v.Set(bh,bp);});};bm=s.ofArray([u.Button("Rpc",$.New(w,{$:0}),bn)]);br=function(){return c.onAjaxClick(function(bt){return v.Set(bi,bt);});};bq=s.ofArray([u.Button("Ajax call",$.New(w,{$:0}),br)]);return u.Element("div",bj,s.ofArray([u.TextNode("Hello world"),u.Element("div",[],bk),u.Element("div",[],bl),u.Element("div",[],bm),u.Element("div",[],bq)]));}}}}});$.OnInit(function(){a=$.Safe($$.ResourceTestWebSharper);b=$.Safe(a.WebSite);c=$.Safe(b.Client);d=$.Safe(c.AjaxHelper);e=$.Safe(d.AjaxOptions);f=$.Safe($$.WebSharper.Concurrency);g=$.Safe($$.WebSharper.Exception);h=$.Safe($$.WebSharper.Option);i=$.Safe($$.jQuery);j=$.Safe($$.String);k=$.Safe($$.console);l=$.Safe(c.Remoting);m=$.Safe(l.CustomXhrProvider);n=$.Safe($$.WebSharper.Remoting);o=$.Safe(n.AjaxRemotingProvider);p=$.Safe($$.WebSharper.UI);q=$.Safe(p.Next);r=$.Safe(q.Var);s=$.Safe($$.WebSharper.List);t=$.Safe(q.AttrProxy);u=$.Safe(q.Doc);v=$.Safe(q.Var1);return w=$.Safe(s.T);});$.OnLoad(function(){l.originalProvider();return;});}());
